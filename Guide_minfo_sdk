
Guide d'Implémentation du SDK Minfo v2.3.0
Note : Ce guide est une version actualisée qui prend en compte l'architecture dynamique et les correctifs de sécurité apportés aujourd'hui.

1. Ce qu'il y a dans le paquet
Le SDK est fourni sous forme de dossier contenant les briques nécessaires pour ajouter la détection AudioQR à votre application. Pour Flutter, vous utiliserez principalement :

flutter/ : Le SDK Dart complet pour iOS et Android.

README.md : Référence technique et exemples de code.

2. Ce que fait réellement le SDK
Le SDK gère l'intégralité du flux "Connect":

Écoute : Active le micro pour détecter un signal AudioQR inaudible.

Décodage : Extrait la signature du signal et l'envoie aux serveurs Minfo.

Réponse : Le serveur renvoie un contenu (URL, lien profond ou instructions).

Action : Le SDK ouvre le contenu pour l'utilisateur. Important : Aucun audio n'est jamais enregistré ou transmis.

3. Architecture et Fichiers Clés
Voici les composants que nous avons stabilisés aujourd'hui:

minfo_sdk.dart : Point d'entrée principal pour l'initialisation et le contrôle du flux.

api_client.dart : Gère la communication avec le backend. Il inclut désormais des logs de débogage et une logique de tentative automatique (retry).

models.dart : Définit les structures de données. Nous avons renforcé la sécurité du parsing JSON pour éviter les crashs si des champs sont nuls ou manquants.

config_manager.dart : Récupère et met en cache la configuration (TTL 15 min) pour garantir que l'app fonctionne même hors-ligne.

secure_storage.dart : Utilise le stockage sécurisé du téléphone (Keychain/Keystore) pour vos clés API.

4. Implémentation Étape par Étape (Flutter)
Installation : Ajoutez le dossier flutter/ comme paquet local et exécutez flutter pub get.

Permissions : Ajoutez les autorisations micro dans AndroidManifest.xml (RECORD_AUDIO) et Info.plist (NSMicrophoneUsageDescription).

Initialisation : Appelez initialise tôt dans votre main.dart avec votre clientId et apiKey.

Détection : Utilisez la méthode connect() pour lancer l'écoute et gérer le résultat structuré (MinfoAllowed, MinfoError, etc.).

5. État actuel et Tâches Restantes
Le moteur de détection et la communication réseau sont désormais robustes. Cependant, pour finaliser l'implémentation en production, les points suivants doivent être réglés :

Authentification Dynamique : Remplacer la clé API fixe par une gestion de jetons (Access Token) via la route LOGIN.

Gestion des Jetons : Implémenter le rafraîchissement automatique des jetons expirés via REFRESH_TOKEN.

Mapping Backend : Assurer que le serveur renvoie le format outcome attendu par le SDK.

6. Checklist de mise en production
 Remplacer le moteur de test (Stub) par le moteur de production.

 Utiliser les identifiants de production réels.

 Vérifier la gestion du cycle de vie (arrière-plan/premier plan).

 Tester les scénarios hors-ligne (cache de configuration).

Souhaites-tu que je génère maintenant une version spécifique de ce guide destinée uniquement à ton équipe Backend pour qu'ils sachent exactement quel format de données renvoyer ?

